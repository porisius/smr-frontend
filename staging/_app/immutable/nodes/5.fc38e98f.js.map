{"version":3,"file":"5.fc38e98f.js","sources":["../../../../../../src/routes/admin/sml-versions/[smlVersionId]/edit/+page.ts","../../../../../../src/routes/admin/sml-versions/[smlVersionId]/edit/+page.svelte"],"sourcesContent":["import type { PageLoad } from './$types';\n\nexport const load: PageLoad = async ({ params }) => ({\n  ...params\n});\n","<script lang=\"ts\">\n  import { getContextClient, queryStore } from '@urql/svelte';\n  import { GetSmlVersionAdminDocument, UpdateSmlVersionDocument } from '$lib/generated';\n  import Toast from '$lib/components/general/Toast.svelte';\n  import { goto } from '$app/navigation';\n  import type { SMLVersionData } from '$lib/models/sml-versions';\n  import SMLVersionForm from '$lib/components/sml-versions/SMLVersionForm.svelte';\n  import { base } from '$app/paths';\n  import MetaDescriptors from '$lib/components/utils/MetaDescriptors.svelte';\n  import Card, { Content } from '@smui/card';\n  import type { PageData } from './$types';\n\n  export let data: PageData;\n\n  const { smlVersionId } = data;\n\n  const client = getContextClient();\n\n  let errorMessage = '';\n  let errorToast = false;\n\n  const smlVersion = queryStore({\n    query: GetSmlVersionAdminDocument,\n    client,\n    variables: { smlVersionID: smlVersionId }\n  });\n\n  const onSubmit = (smlVersionData: SMLVersionData) => {\n    client\n      .mutation(UpdateSmlVersionDocument, {\n        smlVersionID: smlVersionId,\n        smlVersion: smlVersionData\n      })\n      .toPromise()\n      .then((value) => {\n        if (value.error) {\n          console.error(value.error.message);\n          errorMessage = 'Error editing SMLVersion: ' + value.error.message;\n          errorToast = true;\n        } else {\n          // TODO Toast or something\n          goto(base + '/admin/sml-versions');\n        }\n      });\n  };\n\n  $: if (!errorToast) {\n    errorMessage = '';\n  }\n\n  $: initialValues = $smlVersion.data\n    ? ({\n        ...$smlVersion.data.getSMLVersion,\n        logo: undefined\n      } as unknown as SMLVersionData)\n    : undefined;\n</script>\n\n<svelte:head>\n  <MetaDescriptors description=\"Edit SML Version\" title=\"Admin: Edit SML Version\" />\n</svelte:head>\n\n<h1 class=\"text-4xl my-4 font-bold\">Edit SMLVersion</h1>\n\n<Card>\n  <Content>\n    {#if $smlVersion.fetching}\n      <p>Loading...</p>\n    {:else if $smlVersion.error}\n      <p>Oh no... {$smlVersion.error.message}</p>\n    {:else}\n      <SMLVersionForm {onSubmit} {initialValues} editing submitText=\"Save\" />\n    {/if}\n  </Content>\n</Card>\n\n<Toast bind:running={errorToast}>\n  <span>{errorMessage}</span>\n</Toast>\n"],"names":["load","async","params","ctx","error","message","insert_hydration_dev","target","p","anchor","set_data_dev","t1","t1_value","fetching","span","h1","data","$$props","smlVersionId","client","getContextClient","errorMessage","errorToast","smlVersion","queryStore","query","GetSmlVersionAdminDocument","variables","smlVersionID","onSubmit","smlVersionData","mutation","UpdateSmlVersionDocument","toPromise","then","value","console","$$invalidate","goto","base","initialValues","$smlVersion","getSMLVersion","logo","undefined"],"mappings":"okBAEO,MAAMA,GAAiBC,MAAAA,CAASC,aAAc,CAChDA,GAAAA,CAAAA,8rBCkEcC,EAAW,CAACC,EAAAA,MAAMC,QAAO,wCAAnC,WAAA,gEAAA,2FAAHC,CAAAA,EAA0CC,EAAAC,EAAAC,CAAAA,6CAA7BN,EAAW,CAAA,EAACC,MAAMC,QAAO,KAAAK,EAAAC,EAAAC,CAAAA,sLAFnC,qEAAA,YAAA,uEAAHN,CAAAA,EAAgBC,EAAAC,EAAAC,CAAAA,mOADb,OAAAN,KAAYU,SAAQ,EAEfV,GAAYC,EAAAA,MAAK,q/BAStBD,EAAY,CAAA,CAAA,4DAAZA,EAAY,CAAA,CAAA,wEAAnBG,EAA0BC,EAAAO,EAAAL,oCAAnBN,EAAY,uaADAA,EAAU,wBAAVA,EAAU,6HAdK,kNAAA,oNAApCG,EAAAA,EAAuDC,EAAAQ,EAAAN,uMAclCN,EAAU,CAAA,maAhElBa,CAAcC,EAAAA,EAEjB,MAAAC,aAAAA,CAAAA,EAAiBF,EAEnBG,EAASC,EAAAA,EAEX,IAAAC,EAAe,GACfC,EAAa,GAEX,MAAAC,EAAaC,EAAU,CAC3BC,MAAOC,EACPP,SACAQ,UAAS,CAAIC,aAAcV,4CAGvB,MAAAW,EAAYC,GAAAA,CAChBX,EACGY,SAASC,EAAwB,CAChCJ,aAAcV,EACdK,WAAYO,CAEbG,CAAAA,EAAAA,UAAAA,EACAC,KAAMC,GACD,CAAAA,EAAM/B,OACRgC,QAAQhC,MAAM+B,EAAM/B,MAAMC,SAC1BgC,EAAA,EAAAhB,EAAe,6BAA+Bc,EAAM/B,MAAMC,OAC1DgC,EAAAA,EAAA,EAAAf,EAAa,EAAA,GAGbgB,EAAKC,EAAO,8UAmCDjB,CAAAA,EAAUa,6lBA9BrBb,GACNe,EAAA,EAAAhB,EAAe,EAAA,iBAGdgB,EAAA,EAAAG,EAAgBC,EAAYzB,MAEtByB,GAAAA,EAAYzB,KAAK0B,cACpBC,KAAMC,QAERA"}