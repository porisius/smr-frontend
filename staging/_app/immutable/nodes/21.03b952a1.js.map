{"version":3,"file":"21.03b952a1.js","sources":["../../../../../../src/lib/components/mods/ModGrid.svelte","../../../../../../src/routes/mods/+page.svelte"],"sourcesContent":["<script lang=\"ts\">\n  import { queryStore, getContextClient } from '@urql/svelte';\n  import { GetModsDocument, ModFields, Order } from '$lib/generated';\n  import ModCard from './ModCard.svelte';\n  import PageControls from '$lib/components/utils/PageControls.svelte';\n  import { base } from '$app/paths';\n  import Button from '@smui/button';\n  import { Input } from '@smui/textfield';\n  import Paper from '@smui/paper';\n  import Fab from '@smui/fab';\n  import { Icon } from '@smui/common';\n  import { goto } from '$app/navigation';\n  import { page as storePage } from '$app/stores';\n  import { user } from '$lib/stores/user';\n  import FicsitCard from '$lib/components/general/FicsitCard.svelte';\n  import Select, { Option } from '@smui/select';\n  import { browser } from '$app/environment';\n  import { getTranslate } from '@tolgee/svelte';\n\n  export let colCount: 4 | 5 = 4;\n  export let newMod = false;\n  export let showSearch = false;\n\n  const client = getContextClient();\n\n  let search = $storePage.url.searchParams.get('q');\n\n  // TODO Selectable\n  const perPage = 40;\n  let order: Order = Order.Desc;\n  let orderBy: ModFields = ModFields.LastVersionDate;\n\n  let page = parseInt($storePage.url.searchParams.get('p'), 10) || 1;\n\n  $: mods = queryStore({\n    query: GetModsDocument,\n    client,\n    variables: { offset: (page - 1) * perPage, limit: perPage, search, order, orderBy }\n  });\n\n  let totalMods: number;\n\n  let searchField = search;\n\n  let timer: number;\n  $: {\n    clearTimeout(timer);\n    timer = setTimeout(() => {\n      if (searchField && searchField.length > 2) {\n        if ((search === '' || search === null) && searchField !== '' && searchField !== null) {\n          orderBy = ModFields.Search;\n          page = 1;\n        }\n\n        search = searchField;\n      } else if (searchField === '' || searchField === null) {\n        if (orderBy === ModFields.Search || !orderBy) {\n          orderBy = ModFields.LastVersionDate;\n        }\n\n        search = null;\n      }\n    }, 250) as unknown as number;\n  }\n\n  $: if (browser) {\n    const url = new URL(window.location.origin + window.location.pathname);\n    url.searchParams.append('p', page.toString());\n    searchField !== '' && searchField !== null && url.searchParams.append('q', searchField);\n    goto(url.toString(), { keepFocus: true });\n  }\n\n  $: totalMods = $mods?.data?.getMods?.count || 0;\n\n  $: gridClasses =\n    colCount == 4\n      ? '3xl:grid-cols-4 2xl:grid-cols-3 lg:grid-cols-2 grid-cols-1'\n      : '3xl:grid-cols-3 2xl:grid-cols-2 grid-cols-1';\n\n  export const { t } = getTranslate();\n\n  $: orderFields = [\n    [$t('sort-order.name'), 'name'],\n    [$t('sort-order.views'), 'views'],\n    [$t('sort-order.downloads'), 'downloads'],\n    [$t('sort-order.hotness'), 'hotness'],\n    [$t('sort-order.popularity'), 'popularity'],\n    [$t('sort-order.created_at'), 'created_at'],\n    [$t('sort-order.last_version_date'), 'last_version_date'],\n    ...(search !== '' && search !== null ? [[$t('sort-order.search'), 'search']] : [])\n  ];\n</script>\n\n<div class=\"ml-auto flex flex-wrap justify-between items-center mb-5\">\n  {#if newMod && $user !== null}\n    <Button variant=\"outlined\" href=\"{base}/new-mod\">{$t('mods.new')}</Button>\n  {/if}\n\n  {#if showSearch}\n    <div class=\"search-container flex flex-wrap sm:px-4\">\n      <div class=\"mr-3\">\n        <Select bind:value={orderBy} label={$t('order-by')}>\n          {#each orderFields as orderField}\n            <Option value={orderField[1]}>{orderField[0]}</Option>\n          {/each}\n        </Select>\n      </div>\n      <div class=\"mr-3\">\n        <Select bind:value={order} label={$t('order')}>\n          <Option value=\"asc\">{$t('ascending')}</Option>\n          <Option value=\"desc\">{$t('descending')}</Option>\n        </Select>\n      </div>\n      <Paper class=\"search-paper mr-3\" elevation={6}>\n        <Icon class=\"material-icons\">search</Icon>\n        <Input bind:value={searchField} placeholder=\"Search\" />\n      </Paper>\n      <Fab on:click={() => goto(base + '/mods?q=' + search)} color=\"primary\" mini class=\"solo-fab\" aria-label=\"Search\">\n        <Icon class=\"material-icons\">arrow_forward</Icon>\n      </Fab>\n    </div>\n  {/if}\n\n  <div>\n    <PageControls totalPages={Math.ceil(totalMods / perPage)} currentPage={page} />\n  </div>\n</div>\n\n{#if $mods.fetching}\n  <div class=\"grid {gridClasses} gap-4\">\n    {#each Array(perPage) as _}\n      <FicsitCard fake />\n    {/each}\n  </div>\n{:else if $mods.error}\n  <p>Oh no... {$mods.error.message}</p>\n{:else}\n  <div class=\"grid {gridClasses} gap-4\">\n    {#each $mods.data.getMods.mods as mod}\n      <ModCard {mod} />\n    {/each}\n  </div>\n{/if}\n\n<div class=\"mt-5 ml-auto flex justify-end\">\n  <div>\n    <PageControls totalPages={Math.ceil(totalMods / perPage)} currentPage={page} />\n  </div>\n</div>\n\n<style>\n  .search-container {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    flex-grow: 1;\n  }\n\n  * :global(.search-paper) {\n    display: flex;\n    align-items: center;\n    flex-grow: 1;\n    max-width: 600px;\n    height: 48px;\n  }\n\n  * :global(.search-paper > *) {\n    display: inline-block;\n    margin: 0 12px;\n  }\n</style>\n","<script lang=\"ts\">\n  import ModGrid from '$lib/components/mods/ModGrid.svelte';\n  import MetaDescriptors from '$lib/components/utils/MetaDescriptors.svelte';\n</script>\n\n<svelte:head>\n  <MetaDescriptors description=\"Mods available from the Satisfactory Mod Repository\" title=\"Mods\" />\n</svelte:head>\n\n<ModGrid showSearch={true} newMod={true} colCount={4} />\n"],"names":["base","t_1_value","ctx","dirty","set_data_dev","t_1","label","insert_hydration_dev","target","div2","anchor","append_hydration_dev","div0","div1","select0_changes","select1_changes","value","option_changes","length","i","each_blocks","each_value_1","data","getMods","mods","div","error","message","p","t1","t1_value","each_value","Array","perPage","create_if_block_3","create_if_block_2","totalPages","Math","ceil","fetching","div3","pagecontrols0_changes","pagecontrols1_changes","colCount","$$props","newMod","showSearch","client","getContextClient","search","$storePage","url","searchParams","get","order","Order","Desc","orderBy","ModFields","LastVersionDate","page","parseInt","totalMods","searchField","timer","t","getTranslate","click_handler","goto","clearTimeout","$$invalidate","setTimeout","Search","$$subscribe_mods","queryStore","query","GetModsDocument","variables","offset","limit","URL","window","location","origin","pathname","append","toString","keepFocus","$mods","count","gridClasses","orderFields","$t"],"mappings":"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"}