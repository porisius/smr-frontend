{"version":3,"file":"17.Ikck1uaU.js","sources":["../../../../../../src/routes/mod/[modId]/edit/+page.ts","../../../../../../src/routes/mod/[modId]/edit/+page.svelte"],"sourcesContent":["import type { PageLoad } from './$types';\n\nexport const load: PageLoad = async ({ params }) => ({\n  ...params\n});\n","<script lang=\"ts\">\n  import { getContextClient, queryStore } from '@urql/svelte';\n  import { EditModDocument, GetModDocument } from '$lib/generated';\n  import { goto } from '$app/navigation';\n  import ModForm from '$lib/components/mods/ModForm.svelte';\n  import type { ModData } from '$lib/models/mods';\n  import { base } from '$app/paths';\n  import MetaDescriptors from '$lib/components/utils/MetaDescriptors.svelte';\n  import { get } from 'svelte/store';\n  import type { PageData } from './$types';\n  import { getToastStore } from '@skeletonlabs/skeleton';\n\n  export let data: PageData;\n\n  const { modId } = data;\n\n  const client = getContextClient();\n\n  const toastStore = getToastStore();\n\n  const mod = queryStore({\n    query: GetModDocument,\n    client,\n    variables: { mod: modId }\n  });\n\n  const onSubmit = (modData: ModData) => {\n    client\n      .mutation(EditModDocument, {\n        modId: get(mod).data.mod.id,\n        mod: modData\n      })\n      .toPromise()\n      .then((value) => {\n        if (value.error) {\n          console.error(value.error.message);\n          toastStore.trigger({\n            message: 'Error editing mod: ' + value.error.message,\n            background: 'variant-filled-error',\n            autohide: false\n          });\n        } else {\n          toastStore.trigger({\n            message: `Mod updated`,\n            background: 'variant-filled-success',\n            timeout: 5000\n          });\n          goto(base + '/mod/' + value.data.updateMod.id);\n        }\n      });\n  };\n\n  $: initialValues = $mod.data\n    ? {\n        ...$mod.data.mod,\n        logo: undefined\n      }\n    : undefined;\n</script>\n\n<svelte:head>\n  {#if !$mod.fetching && !$mod.error && $mod.data.mod}\n    <MetaDescriptors\n      description=\"Editing mod {$mod.data.mod.name}\"\n      title=\"Edit mod {$mod.data.mod.name}\"\n      image={$mod.data.mod.logo} />\n  {/if}\n</svelte:head>\n\n<h1 class=\"my-4 text-4xl font-bold\">Edit Mod</h1>\n\n<div class=\"card p-4\">\n  <section>\n    {#if $mod.fetching}\n      <p>Loading...</p>\n    {:else if $mod.error}\n      <p>Oh no... {$mod.error.message}</p>\n    {:else}\n      <ModForm {onSubmit} {initialValues} editing={true} submitText=\"Save\" />\n    {/if}\n  </section>\n</div>\n"],"names":["load","async","params","e","description","ctx","data","mod","name","title","image","logo","dirty","metadescriptors_changes","error","message","insert_hydration","target","p","anchor","set_data","t1","t1_value","fetching","create_if_block_2","h1","div","append_hydration","section","$$props","modId","client","getContextClient","toastStore","getToastStore","queryStore","query","GetModDocument","variables","onSubmit","modData","mutation","EditModDocument","get","id","toPromise","then","value","console","trigger","background","autohide","timeout","goto","base","updateMod","$$invalidate","initialValues","$mod","undefined"],"mappings":"wbAEO,MAAMA,GAAiBC,MAAAA,CAASC,OAAcC,CAAA,KAAA,CAAA,GAChDD,wJC4D2BE,YAAA,eAAAC,EAAK,CAAA,EAAAC,KAAKC,IAAIC,KACvBC,MAAA,YAAAJ,EAAK,CAAAC,EAAAA,KAAKC,IAAIC,KACxBE,MAAAL,EAAK,CAAAC,EAAAA,KAAKC,IAAII,IAAAA,CAAAA,CAAAA,0FAFKC,EAAA,IAAAC,EAAAT,YAAA,eAAAC,EAAK,CAAA,EAAAC,KAAKC,IAAIC,MACvBI,EAAA,IAAAC,EAAAJ,MAAA,YAAAJ,EAAK,CAAAC,EAAAA,KAAKC,IAAIC,MACxBI,EAAA,IAAAC,EAAAH,MAAAL,EAAK,CAAAC,EAAAA,KAAKC,IAAII,wLAawB,+PAFhCN,EAAI,CAAA,EAACS,MAAMC,QAAO,6BAA5B,WAAA,8CAAA,0CAAHC,CAAAA,EAAmCC,EAAAC,EAAAC,qCAAtBd,EAAI,GAACS,MAAMC,QAAO,KAAAK,EAAAC,EAAAC,CAAAA,0LAF/BN,EAAgBC,EAAAC,EAAAC,oFAbdd,EAAI,CAAA,EAACkB,UAAalB,CAAAA,EAAI,CAACS,EAAAA,OAAST,EAAI,CAAA,EAACC,KAAKC,KAAGiB,EAAAnB,CAAAA,0CAY5C,OAAAA,GAAKkB,EAAAA,SAAQ,EAERlB,GAAKS,EAAAA,MAAK,kiBANxBE,EAAgDC,EAAAQ,EAAAN,CAAAA,WAEhDH,EAUKC,EAAAS,EAAAP,CAAAA,EATHQ,EAQSD,EAAAE,kCAnBHvB,EAAI,CAACkB,EAAAA,UAAAA,CAAalB,EAAI,CAAA,EAACS,OAAST,EAAI,CAACC,EAAAA,KAAKC,sXAjDrCD,CAAcuB,EAAAA,EAEjB,KAAAC,CAAAA,MAAAA,CAAUxB,EAAAA,EAEZyB,EAASC,EAET,EAAAC,EAAaC,EAAAA,EAEb3B,EAAM4B,EAAU,CACpBC,MAAOC,GACPN,SACAO,UAAS,CAAI/B,IAAKuB,CAAAA,CAAAA,CAAAA,qBAGd,MAAAS,EAAYC,GAChBT,CAAAA,EACGU,SAASC,GAAe,CACvBZ,MAAOa,EAAIpC,CAAAA,EAAKD,KAAKC,IAAIqC,GACzBrC,IAAKiC,CAENK,CAAAA,EAAAA,UAAAA,EACAC,KAAMC,GAAAA,CACDA,EAAMjC,OACRkC,QAAQlC,MAAMiC,EAAMjC,MAAMC,OAC1BkB,EAAAA,EAAWgB,QAAO,CAChBlC,QAAS,sBAAwBgC,EAAMjC,MAAMC,QAC7CmC,WAAY,uBACZC,SAAU,OAGZlB,EAAWgB,QAAO,CAChBlC,QAAO,cACPmC,WAAY,yBACZE,QAAS,GAAA,CAAA,EAEXC,EAAKC,EAAO,QAAUP,EAAMzC,KAAKiD,UAAUX,EAAAA,mFAKhDY,EAAA,EAAAC,EAAgBC,EAAKpD,KAEf,CAAAoD,GAAAA,EAAKpD,KAAKC,IACbI,KAAMgD,MAAAA,EAERA"}