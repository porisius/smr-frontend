import{S as z,i as Y,s as ee,e as $,c as v,d as L,f as m,G as h,j as p,t as w,l as J,m as N,K as te,L as ae,Z as ne,X as se,k as K,u as re,_ as ie,A as Q,a as H,D as W,g as D,F,H as X,I as x,W as b,J as Z,T as S,U as B,V as _,q as P,Q as V,b as R,R as le,$ as oe,a0 as E,a1 as ce}from"../chunks/vendor.qkHm75Lx.js";import{a as ue,C as fe,U as de,b as ge}from"../chunks/graphql.XSrPrpK2.js";function j(r,t,a){const e=r.slice();return e[18]=t[a],e[19]=t,e[20]=a,e}function me(r){let t,a,e,n,l='<span>Add new tag</span> <span class="material-icons">add</span>',s,u,i;return t=new ie({props:{$$slots:{default:[Te]},$$scope:{ctx:r}}}),{c(){Q(t.$$.fragment),a=H(),e=$("section"),n=$("button"),n.innerHTML=l,this.h()},l(f){W(t.$$.fragment,f),a=D(f),e=v(f,"SECTION",{class:!0});var d=L(e);n=v(d,"BUTTON",{class:!0,"data-svelte-h":!0}),F(n)!=="svelte-rv47m0"&&(n.innerHTML=l),d.forEach(m),this.h()},h(){h(n,"class","variant-ghost-primary btn"),h(e,"class","p-4")},m(f,d){X(t,f,d),p(f,a,d),p(f,e,d),x(e,n),s=!0,u||(i=b(n,"click",r[4]),u=!0)},p(f,d){const y={};d&2097158&&(y.$$scope={dirty:d,ctx:f}),t.$set(y)},i(f){s||(N(t.$$.fragment,f),s=!0)},o(f){w(t.$$.fragment,f),s=!1},d(f){f&&(m(a),m(e)),Z(t,f),u=!1,i()}}}function pe(r){let t,a,e=r[0].error.message+"",n;return{c(){t=$("h1"),a=S("Failed to load tags: "),n=S(e)},l(l){t=v(l,"H1",{});var s=L(t);a=B(s,"Failed to load tags: "),n=B(s,e),s.forEach(m)},m(l,s){p(l,t,s),x(t,a),x(t,n)},p(l,s){s&1&&e!==(e=l[0].error.message+"")&&_(n,e)},i:P,o:P,d(l){l&&m(t)}}}function he(r){let t,a="Loading tags...";return{c(){t=$("h1"),t.textContent=a},l(e){t=v(e,"H1",{"data-svelte-h":!0}),F(t)!=="svelte-ud4eq5"&&(t.textContent=a)},m(e,n){p(e,t,n)},p:P,i:P,o:P,d(e){e&&m(t)}}}function $e(r){let t=r[18].name+"",a;return{c(){a=S(t)},l(e){a=B(e,t)},m(e,n){p(e,a,n)},p(e,n){n&2&&t!==(t=e[18].name+"")&&_(a,t)},d(e){e&&m(a)}}}function ve(r){let t,a,e=r[18],n,l,s,u,i="Human-Readable name and description of the tag that is shown in UI",f,d,y="<span>Delete</span>",T,k,I;function q(){r[7].call(a,r[19],r[20])}const U=()=>r[8](a,e),C=()=>r[8](null,e);function O(){return r[9](r[18])}function A(){r[10].call(l,r[19],r[20])}function M(){return r[11](r[18])}function o(...c){return r[12](r[18],...c)}return{c(){t=$("div"),a=$("input"),n=H(),l=$("input"),s=H(),u=$("span"),u.textContent=i,f=H(),d=$("button"),d.innerHTML=y,T=H(),this.h()},l(c){t=v(c,"DIV",{});var g=L(t);a=v(g,"INPUT",{type:!0,class:!0,placeholder:!0}),n=D(g),l=v(g,"INPUT",{type:!0,class:!0,placeholder:!0}),g.forEach(m),s=D(c),u=v(c,"SPAN",{slot:!0,"data-svelte-h":!0}),F(u)!=="svelte-2kgxo4"&&(u.textContent=i),f=D(c),d=v(c,"BUTTON",{class:!0,"data-svelte-h":!0}),F(d)!=="svelte-47guuq"&&(d.innerHTML=y),T=D(c),this.h()},h(){h(a,"type","text"),h(a,"class","input p-2"),h(a,"placeholder","Name"),h(l,"type","text"),h(l,"class","input p-2"),h(l,"placeholder","Description"),h(u,"slot","helper"),h(d,"class","variant-ghost-error btn")},m(c,g){p(c,t,g),x(t,a),E(a,r[18].name),U(),x(t,n),x(t,l),E(l,r[18].description),p(c,s,g),p(c,u,g),p(c,f,g),p(c,d,g),p(c,T,g),k||(I=[b(a,"input",q),b(a,"change",O),b(l,"input",A),b(l,"change",M),b(d,"click",o)],k=!0)},p(c,g){r=c,g&2&&a.value!==r[18].name&&E(a,r[18].name),e!==r[18]&&(C(),e=r[18],U()),g&2&&l.value!==r[18].description&&E(l,r[18].description)},d(c){c&&(m(t),m(s),m(u),m(f),m(d),m(T)),C(),k=!1,ce(I)}}}function G(r){let t,a;return t=new oe({props:{$$slots:{content:[ve],summary:[$e]},$$scope:{ctx:r}}}),{c(){Q(t.$$.fragment)},l(e){W(t.$$.fragment,e)},m(e,n){X(t,e,n),a=!0},p(e,n){const l={};n&2097158&&(l.$$scope={dirty:n,ctx:e}),t.$set(l)},i(e){a||(N(t.$$.fragment,e),a=!0)},o(e){w(t.$$.fragment,e),a=!1},d(e){Z(t,e)}}}function Te(r){let t,a,e=V(r[1]),n=[];for(let s=0;s<e.length;s+=1)n[s]=G(j(r,e,s));const l=s=>w(n[s],1,1,()=>{n[s]=null});return{c(){for(let s=0;s<n.length;s+=1)n[s].c();t=R()},l(s){for(let u=0;u<n.length;u+=1)n[u].l(s);t=R()},m(s,u){for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(s,u);p(s,t,u),a=!0},p(s,u){if(u&102){e=V(s[1]);let i;for(i=0;i<e.length;i+=1){const f=j(s,e,i);n[i]?(n[i].p(f,u),N(n[i],1)):(n[i]=G(f),n[i].c(),N(n[i],1),n[i].m(t.parentNode,t))}for(K(),i=e.length;i<n.length;i+=1)l(i);J()}},i(s){if(!a){for(let u=0;u<e.length;u+=1)N(n[u]);a=!0}},o(s){n=n.filter(Boolean);for(let u=0;u<n.length;u+=1)w(n[u]);a=!1},d(s){s&&m(t),le(n,s)}}}function ye(r){let t,a,e,n;const l=[he,pe,me],s=[];function u(i,f){return i[0].fetching?0:i[0].error?1:2}return a=u(r),e=s[a]=l[a](r),{c(){t=$("div"),e.c(),this.h()},l(i){t=v(i,"DIV",{class:!0});var f=L(t);e.l(f),f.forEach(m),this.h()},h(){h(t,"class","card")},m(i,f){p(i,t,f),s[a].m(t,null),n=!0},p(i,[f]){let d=a;a=u(i),a===d?s[a].p(i,f):(K(),w(s[d],1,1,()=>{s[d]=null}),J(),e=s[a],e?e.p(i,f):(e=s[a]=l[a](i),e.c()),N(e,1),e.m(t,null))},i(i){n||(N(e),n=!0)},o(i){w(e),n=!1},d(i){i&&m(t),s[a].d()}}}function Ne(r,t,a){let e;const n=te();let l=[];const s={},u={};let i=-1;const f=ae({query:ue,client:n,variables:{limit:100}});ne(r,f,o=>a(0,e=o));const d=se();function y(){if(l.find(o=>o.name=="New Tag"))s[l[l.length-1].id].setOpen(!0),u[l[l.length-1].id].focus();else{const o={id:i--,name:"New Tag",description:"Description"};l.push(o),a(1,l),a(0,e),setTimeout(()=>{s[o.id].setOpen(!0);const c=u[o.id];c.focus(),c.getElement().querySelectorAll("input")[0].select()},0)}}async function T(o){if(o.name=="New Tag")return;let c=!1;if(o.id<0){try{const g=await n.mutation(fe,{tagName:o.name,description:o.description}).toPromise();g.data&&(o.id=g.data.createTag.id,c=!0)}catch(g){console.log(g)}if(!c){d.trigger({message:`Failed to create Tag '${o.name}'!`,background:"variant-filled-error",timeout:2e3});return}}else{try{c=(await n.mutation(de,{tagID:o.id,tagName:o.name,description:o.description}).toPromise()).data.updateTag!=null}catch{}if(!c){d.trigger({message:`Failed to update Tag '${o.name}'!`,background:"variant-filled-error",timeout:2e3});return}}d.trigger({message:`Tag '${o.name}' saved!`,background:"variant-filled-success",timeout:2e3})}async function k(o){if(o.name!="New Tag"){let c=!1;try{c=(await n.mutation(ge,{tagID:o.id}).toPromise()).data.deleteTag}catch{c=!1}if(!c){d.trigger({message:`Failed to remove Tag '${o.name}'!`,background:"variant-filled-error",timeout:2e3});return}}d.trigger({message:`Tag '${o.name}' removed!`,background:"variant-filled-success",timeout:2e3})}function I(o,c){o.stopPropagation(),k(c)}function q(o,c){o[c].name=this.value,a(1,l),a(0,e)}function U(o,c){re[o?"unshift":"push"](()=>{u[c.id]=o,a(2,u)})}const C=o=>T(o);function O(o,c){o[c].description=this.value,a(1,l),a(0,e)}const A=o=>T(o),M=(o,c)=>I(c,o);return r.$$.update=()=>{r.$$.dirty&1&&a(1,l=e.data?.getTags||[])},[e,l,u,f,y,T,I,q,U,C,O,A,M]}class we extends z{constructor(t){super(),Y(this,t,Ne,ye,ee,{})}}export{we as component};
//# sourceMappingURL=7.Ikt6z6zP.js.map
