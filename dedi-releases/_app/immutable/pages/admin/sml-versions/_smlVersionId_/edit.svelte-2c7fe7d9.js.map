{"version":3,"file":"edit.svelte-2c7fe7d9.js","sources":["../../../../../../../../../src/routes/admin/sml-versions/[smlVersionId]/edit.svelte"],"sourcesContent":["<script lang=\"ts\" context=\"module\">\n  import { paramsToProps } from '$lib/utils/routing';\n\n  export const load = paramsToProps();\n</script>\n\n<script lang=\"ts\">\n  import { mutation, operationStore, query } from '@urql/svelte';\n  import { GetSmlVersionAdminDocument, UpdateSmlVersionDocument } from '$lib/generated';\n  import Toast from '$lib/components/general/Toast.svelte';\n  import { goto } from '$app/navigation';\n  import type { SMLVersionData } from '$lib/models/sml-versions';\n  import SMLVersionForm from '$lib/components/sml-versions/SMLVersionForm.svelte';\n  import { base } from '$app/paths';\n  import MetaDescriptors from '$lib/components/utils/MetaDescriptors.svelte';\n  import Card, { Content } from '@smui/card';\n\n  export let smlVersionId!: string;\n\n  let errorMessage = '';\n  let errorToast = false;\n\n  const smlVersion = operationStore(GetSmlVersionAdminDocument, { smlVersionID: smlVersionId });\n\n  const editSMLVersion = mutation({\n    query: UpdateSmlVersionDocument\n  });\n\n  const onSubmit = (data: SMLVersionData) => {\n    editSMLVersion({\n      smlVersionID: smlVersionId,\n      smlVersion: data\n    }).then((value) => {\n      if (value.error) {\n        console.error(value.error.message);\n        errorMessage = 'Error editing SMLVersion: ' + value.error.message;\n        errorToast = true;\n      } else {\n        // TODO Toast or something\n        goto(base + '/admin/sml-versions');\n      }\n    });\n  };\n\n  $: if (!errorToast) {\n    errorMessage = '';\n  }\n\n  $: initialValues = $smlVersion.data\n    ? ({\n        ...$smlVersion.data.getSMLVersion,\n        logo: undefined\n      } as unknown as SMLVersionData)\n    : undefined;\n\n  query(smlVersion);\n</script>\n\n<svelte:head>\n  <MetaDescriptors description=\"Edit SML Version\" title=\"Admin: Edit SML Version\" />\n</svelte:head>\n\n<h1 class=\"text-4xl my-4 font-bold\">Edit SMLVersion</h1>\n\n<Card>\n  <Content>\n    {#if $smlVersion.fetching}\n      <p>Loading...</p>\n    {:else if $smlVersion.error}\n      <p>Oh no... {$smlVersion.error.message}</p>\n    {:else}\n      <SMLVersionForm {onSubmit} {initialValues} submitText=\"Save\" />\n    {/if}\n  </Content>\n</Card>\n\n<Toast bind:running={errorToast}>\n  <span>{errorMessage}</span>\n</Toast>\n"],"names":["ctx","error","message","insert_hydration","target","p","anchor","set_data","t1","t1_value","fetching","span","h1","load","paramsToProps","smlVersionId","$$props","errorMessage","errorToast","smlVersion","operationStore","GetSmlVersionAdminDocument","smlVersionID","editSMLVersion","mutation","query","UpdateSmlVersionDocument","onSubmit","data","then","value","console","$$invalidate","goto","base","initialValues","$smlVersion","getSMLVersion","logo","undefined"],"mappings":"m1CAqEmBA,EAAW,GAACC,MAAMC,QAAO,6BAAnC,WAAA,8CAAA,0CAAHC,CAAAA,EAA0CC,EAAAC,EAAAC,qCAA7BN,EAAW,GAACC,MAAMC,QAAO,KAAAK,EAAAC,EAAAC,0EAFnC,YAAA,CAAA,sCAAA,YAAA,sBAAHN,CAAAA,EAAgBC,EAAAC,EAAAC,wGADb,CAAA,MAAAN,MAAYU,SAAQ,EAEfV,KAAYC,MAAK,wpBAStBD,EAAY,4CAAZA,EAAY,yBAAnBG,EAA0BC,EAAAO,EAAAL,CAAAA,0BAAnBN,EAAY,mRADAA,GAAU,KAAA,mBAAVA,EAAU,+FAdK,wNAAA,iBAAA,iKAApCG,EAAuDC,EAAAQ,EAAAN,CAAAA,2LAclCN,EAAU,8NAzEhB,CAAA,CAAA,CAAA,CAAA,KAAAa,IAAOC,EAAAA,2CAcTC,GAAqBC,EAE5BC,EAAe,GACfC,EAAa,GAEX,KAAAC,GAAaC,EAAeC,EAA8B,CAAAC,aAAcP,CAAAA,CAAAA,qBAExE,KAAAQ,GAAiBC,EACrB,CAAAC,MAAOC,EAGH,CAAA,EAAAC,EAAYC,GAAAA,CAChBL,EAAc,CACZD,aAAcP,EACdI,WAAYS,CAAAA,CAAAA,EACXC,KAAMC,GAAAA,CACH,AAAAA,EAAM7B,MACR8B,SAAQ9B,MAAM6B,EAAM7B,MAAMC,OAAAA,EAC1B8B,EAAA,EAAAf,EAAe,6BAA+Ba,EAAM7B,MAAMC,OAC1D8B,EAAAA,EAAA,EAAAd,EAAa,KAGbe,GAAKC,GAAO,qBAAA,CAAA,CAAA,CAAA,EAgBlBT,EAAMN,CAAAA,eAqBaD,CAAAA,EAAUY,sGAhCrBZ,IACNc,EAAA,EAAAf,EAAe,EAAA,iBAGde,EAAA,EAAAG,EAAgBC,EAAYR,MAEtBQ,GAAAA,EAAYR,KAAKS,cACpBC,KAAMC,MAAAA,EAERA"}